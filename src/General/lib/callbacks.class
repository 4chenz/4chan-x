class Callbacks
  constructor: (@type) ->
    @keys = []
    @runTime = {}

  push: ({name, cb}) ->
    @keys.push name unless @[name]
    @[name] = cb

  execute: (node) ->
    for name in @keys
      try
        @runTime[name] or= 0
        t1 = Date.now()
        @[name].call node
        @runTime[name] += Date.now() - t1
      catch err
        errors = [] unless errors
        errors.push
          message: ['"', name, '" crashed on node ', @type, ' No.', node.ID, ' (', node.board, ').'].join('')
          error: err

    Main.handleErrors errors if errors
